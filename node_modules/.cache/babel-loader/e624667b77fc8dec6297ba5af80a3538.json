{"ast":null,"code":"import _asyncToGenerator from\"/home/ec2-user/ShoppingApp/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/home/ec2-user/ShoppingApp/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"/home/ec2-user/ShoppingApp/node_modules/@babel/runtime/regenerator/index.js\";import{useRef,useState,useEffect,useContext}from'react';import CatalogList from'./CatalogList';import axios from'./api/axios';import{useNavigate}from'react-router-dom';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var LOGIN_URL='/v1/user/login';var Login=function Login(){var userRef=useRef();var errRef=useRef();var navigate=useNavigate();var _useState=useState(''),_useState2=_slicedToArray(_useState,2),user=_useState2[0],setUser=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),pwd=_useState4[0],setPwd=_useState4[1];var _useState5=useState(''),_useState6=_slicedToArray(_useState5,2),errMsg=_useState6[0],setErrMsg=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),success=_useState8[0],setSuccess=_useState8[1];useEffect(function(){userRef.current.focus();},[]);useEffect(function(){setErrMsg('');},[user,pwd]);var handleSubmit=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(e){var login,response,_err$response,_err$response2;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:e.preventDefault();_context.prev=1;login={\"username\":user,\"password\":pwd};_context.next=5;return axios.post(LOGIN_URL,login,null);case 5:response=_context.sent;if(response){_context.next=13;break;}setErrMsg('Login Failed');setUser('');setPwd('');throw errMsg;case 13:setUser('');setPwd('');// setSuccess(true);\n// if (success) {\n// \tnavigate('/catalog')\n// }\n// console.log('user in login',response.data);\n_context.next=17;return localStorage.setItem('user',JSON.stringify(response.data));case 17:// let user = JSON.parse(localStorage.getItem('user'))\n// console.log('user',user);\nnavigate('/');case 18:_context.next=24;break;case 20:_context.prev=20;_context.t0=_context[\"catch\"](1);if(!(_context.t0!==null&&_context.t0!==void 0&&_context.t0.response)){setErrMsg('No Server Response');}else if(((_err$response=_context.t0.response)===null||_err$response===void 0?void 0:_err$response.status)===400){setErrMsg('Missing Username or Password');}else if(((_err$response2=_context.t0.response)===null||_err$response2===void 0?void 0:_err$response2.status)===401){setErrMsg('Unauthorized');}else{setErrMsg('Login Failed');}errRef.current.focus();case 24:case\"end\":return _context.stop();}}},_callee,null,[[1,20]]);}));return function handleSubmit(_x){return _ref.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(\"section\",{children:[/*#__PURE__*/_jsx(\"p\",{ref:errRef,className:errMsg?'errmsg':'offscreen',\"aria-live\":\"assertive\",children:errMsg}),/*#__PURE__*/_jsx(\"h1\",{children:\"Sign In\"}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"username\",children:\"Username:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",id:\"username\",ref:userRef,autoComplete:\"off\",onChange:function onChange(e){return setUser(e.target.value);},value:user,required:true}),/*#__PURE__*/_jsx(\"label\",{htmlFor:\"password\",children:\"Password:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"password\",id:\"password\",onChange:function onChange(e){return setPwd(e.target.value);},value:pwd,required:true}),/*#__PURE__*/_jsx(\"button\",{children:\"Sign In\"})]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Need an Account?\",/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"span\",{className:\"line\",children:/*#__PURE__*/_jsx(\"a\",{href:\"/signup\",children:\"Sign Up\"})})]})]});};export default Login;","map":{"version":3,"sources":["/home/ec2-user/ShoppingApp/src/Login.jsx"],"names":["useRef","useState","useEffect","useContext","CatalogList","axios","useNavigate","LOGIN_URL","Login","userRef","errRef","navigate","user","setUser","pwd","setPwd","errMsg","setErrMsg","success","setSuccess","current","focus","handleSubmit","e","preventDefault","login","post","response","localStorage","setItem","JSON","stringify","data","status","target","value"],"mappings":"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","sourcesContent":["import { useRef, useState, useEffect, useContext } from 'react';\n\nimport CatalogList from './CatalogList';\nimport axios from './api/axios';\nimport { useNavigate } from 'react-router-dom';\nconst LOGIN_URL = '/v1/user/login';\n\nconst Login = () => {\n\tconst userRef = useRef();\n\tconst errRef = useRef();\n\tconst navigate = useNavigate()\n\n\tconst [user, setUser] = useState('');\n\tconst [pwd, setPwd] = useState('');\n\tconst [errMsg, setErrMsg] = useState('');\n\tconst [success, setSuccess] = useState(false);\n\n\tuseEffect(() => {\n\t\tuserRef.current.focus();\n\t}, []);\n\n\tuseEffect(() => {\n\t\tsetErrMsg('');\n\t}, [user, pwd]);\n\n\tconst handleSubmit = async (e) => {\n\t\te.preventDefault();\n\n\t\ttry {\n\t\t\tlet login = {\n\t\t\t\t\"username\": user,\n\t\t\t\t\"password\": pwd\n\t\t\t}\n\t\t\tlet response = await axios.post(LOGIN_URL, login, null);\n\t\t\t// console.log(response.data);\n\t\t\tif(!response){\n\t\t\t\tsetErrMsg('Login Failed');\n\t\t\t\tsetUser('');\n\t\t\t\tsetPwd('');\n\t\t\t\tthrow errMsg;\n\t\t\t} else {\n\t\t\t\tsetUser('');\n\t\t\t\tsetPwd('');\n\t\t\t\t// setSuccess(true);\n\t\t\t\t// if (success) {\n\t\t\t\t// \tnavigate('/catalog')\n\t\t\t\t// }\n\t\t\t\t// console.log('user in login',response.data);\n\t\t\t\tawait localStorage.setItem('user',JSON.stringify(response.data))\n\t\t\t\t// let user = JSON.parse(localStorage.getItem('user'))\n\t\t\t\t// console.log('user',user);\n\t\t\t\tnavigate('/')\n\t\t\t}\n\t\t} catch (err) {\n\t\t\tif (!err?.response) {\n\t\t\t\tsetErrMsg('No Server Response');\n\t\t\t} else if (err.response?.status === 400) {\n\t\t\t\tsetErrMsg('Missing Username or Password');\n\t\t\t} else if (err.response?.status === 401) {\n\t\t\t\tsetErrMsg('Unauthorized');\n\t\t\t} else {\n\t\t\t\tsetErrMsg('Login Failed');\n\t\t\t}\n\t\t\terrRef.current.focus();\n\t\t}\n\t};\n\n\treturn (\n\t\t<section>\n\t\t\t\t\t<p\n\t\t\t\t\t\tref={errRef}\n\t\t\t\t\t\tclassName={errMsg ? 'errmsg' : 'offscreen'}\n\t\t\t\t\t\taria-live=\"assertive\"\n\t\t\t\t\t>\n\t\t\t\t\t\t{errMsg}\n\t\t\t\t\t</p>\n\t\t\t\t\t<h1>Sign In</h1>\n\t\t\t\t\t<form onSubmit={handleSubmit}>\n\t\t\t\t\t\t<label htmlFor=\"username\">Username:</label>\n\t\t\t\t\t\t<input\n\t\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\t\tid=\"username\"\n\t\t\t\t\t\t\tref={userRef}\n\t\t\t\t\t\t\tautoComplete=\"off\"\n\t\t\t\t\t\t\tonChange={(e) => setUser(e.target.value)}\n\t\t\t\t\t\t\tvalue={user}\n\t\t\t\t\t\t\trequired\n\t\t\t\t\t\t/>\n\n\t\t\t\t\t\t<label htmlFor=\"password\">Password:</label>\n\t\t\t\t\t\t<input\n\t\t\t\t\t\t\ttype=\"password\"\n\t\t\t\t\t\t\tid=\"password\"\n\t\t\t\t\t\t\tonChange={(e) => setPwd(e.target.value)}\n\t\t\t\t\t\t\tvalue={pwd}\n\t\t\t\t\t\t\trequired\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<button>Sign In</button>\n\t\t\t\t\t</form>\n\t\t\t\t\t<p>\n\t\t\t\t\t\tNeed an Account?\n\t\t\t\t\t\t<br />\n\t\t\t\t\t\t<span className=\"line\">\n\t\t\t\t\t\t\t<a href=\"/signup\">Sign Up</a>\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</p>\n\t\t\t\t</section>\n\t);\n};\n\nexport default Login;\n"]},"metadata":{},"sourceType":"module"}