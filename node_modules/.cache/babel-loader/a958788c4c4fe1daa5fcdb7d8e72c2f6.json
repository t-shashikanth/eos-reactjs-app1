{"ast":null,"code":"import _objectSpread from\"/home/ec2-user/ShoppingApp/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _asyncToGenerator from\"/home/ec2-user/ShoppingApp/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/home/ec2-user/ShoppingApp/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"/home/ec2-user/ShoppingApp/node_modules/@babel/runtime/regenerator/index.js\";import React,{useState,useEffect}from'react';import{useLocation,useNavigate}from'react-router-dom';import axios from'./api/axios';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var PAYMENT_URL='/v1/payment';var ORDER_URL='/v1/order';var Payment=function Payment(props){var location=useLocation();var navigate=useNavigate();console.log('state',location.state);var _useState=useState(),_useState2=_slicedToArray(_useState,2),_useState2$=_useState2[0],payment=_useState2$===void 0?{cardHolder:'',cardNumber:'',validation:'',cvv:''}:_useState2$,setPayment=_useState2[1];var _useState3=useState(),_useState4=_slicedToArray(_useState3,2),upi=_useState4[0],setUPI=_useState4[1];var _useState5=useState('Select Mode'),_useState6=_slicedToArray(_useState5,2),modeValue=_useState6[0],setModeValue=_useState6[1];var _useState7=useState(),_useState8=_slicedToArray(_useState7,2),cartData=_useState8[0],setCartData=_useState8[1];useEffect(function(){var _location$state;setCartData((_location$state=location.state)===null||_location$state===void 0?void 0:_location$state.element);},[!cartData]);var onPayment=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(event){var kartId,user,data,paymentresponse,_paymentresponse$data,orderdata,response;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;event.preventDefault();console.log('payment',payment);// navigate('/order',{state:{paymentid:1}})\nkartId=JSON.parse(localStorage.getItem('cartId'));user=JSON.parse(localStorage.getItem('user'));data={kartId:kartId,cardHolder:payment===null||payment===void 0?void 0:payment.cardHolder,cardNumber:payment===null||payment===void 0?void 0:payment.cardNumber,validation:payment===null||payment===void 0?void 0:payment.validation,cvv:payment===null||payment===void 0?void 0:payment.cvv,mode:'CARD'};_context.next=8;return axios.post(PAYMENT_URL,data,null);case 8:paymentresponse=_context.sent;if(!paymentresponse){_context.next=15;break;}orderdata={paymentId:paymentresponse===null||paymentresponse===void 0?void 0:(_paymentresponse$data=paymentresponse.data)===null||_paymentresponse$data===void 0?void 0:_paymentresponse$data.id,userId:user.id,item:cartData===null||cartData===void 0?void 0:cartData.item};_context.next=13;return axios.post(ORDER_URL,orderdata,null);case 13:response=_context.sent;if(response){navigate('/success');}case 15:_context.next=20;break;case 17:_context.prev=17;_context.t0=_context[\"catch\"](0);console.log('paymentError',_context.t0);case 20:case\"end\":return _context.stop();}}},_callee,null,[[0,17]]);}));return function onPayment(_x){return _ref.apply(this,arguments);};}();var onUpiPayment=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var kartId,user,data,paymentresponse,_paymentresponse$data2,orderdata,response;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;kartId=JSON.parse(localStorage.getItem('cartId'));user=JSON.parse(localStorage.getItem('user'));data={kartId:kartId,mode:'UPI'};_context2.next=6;return axios.post(PAYMENT_URL,data,null);case 6:paymentresponse=_context2.sent;if(!paymentresponse){_context2.next=13;break;}orderdata={paymentId:paymentresponse===null||paymentresponse===void 0?void 0:(_paymentresponse$data2=paymentresponse.data)===null||_paymentresponse$data2===void 0?void 0:_paymentresponse$data2.id,userId:user.id,vpa:upi,item:cartData===null||cartData===void 0?void 0:cartData.item};_context2.next=11;return axios.post(ORDER_URL,orderdata,null);case 11:response=_context2.sent;if(response){navigate('/success');}case 13:_context2.next=18;break;case 15:_context2.prev=15;_context2.t0=_context2[\"catch\"](0);console.log('upiError',_context2.t0);case 18:case\"end\":return _context2.stop();}}},_callee2,null,[[0,15]]);}));return function onUpiPayment(){return _ref2.apply(this,arguments);};}();var onCodPayment=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(){var kartId,user,data,paymentresponse,_paymentresponse$data3,orderdata,response;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.prev=0;kartId=JSON.parse(localStorage.getItem('cartId'));user=JSON.parse(localStorage.getItem('user'));data={kartId:kartId,mode:'COD'};_context3.next=6;return axios.post(PAYMENT_URL,data,null);case 6:paymentresponse=_context3.sent;if(!paymentresponse){_context3.next=13;break;}orderdata={paymentId:paymentresponse===null||paymentresponse===void 0?void 0:(_paymentresponse$data3=paymentresponse.data)===null||_paymentresponse$data3===void 0?void 0:_paymentresponse$data3.id,userId:user.id,item:cartData===null||cartData===void 0?void 0:cartData.item};_context3.next=11;return axios.post(ORDER_URL,orderdata,null);case 11:response=_context3.sent;if(response){navigate('/success');}case 13:_context3.next=18;break;case 15:_context3.prev=15;_context3.t0=_context3[\"catch\"](0);console.log('codError',_context3.t0);case 18:case\"end\":return _context3.stop();}}},_callee3,null,[[0,15]]);}));return function onCodPayment(){return _ref3.apply(this,arguments);};}();var handleChange=function handleChange(e){console.log('e',e.target.value);setModeValue(e.target.value);};return/*#__PURE__*/_jsx(\"div\",{className:\"container\",children:/*#__PURE__*/_jsx(\"div\",{className:\"row\",children:/*#__PURE__*/_jsx(\"div\",{className:\"col-md-12 d-flex justify-content-center align-item-center\",children:/*#__PURE__*/_jsx(\"div\",{className:\"card\",children:/*#__PURE__*/_jsx(\"div\",{className:\"body\",children:modeValue==='CARD'?/*#__PURE__*/_jsxs(\"form\",{className:\"p-2\",onSubmit:onPayment,children:[/*#__PURE__*/_jsx(\"div\",{className:\"form-group\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"mb-3\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"exampleInputEmail1\",className:\"form-label\",children:\"Card holder*\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:payment===null||payment===void 0?void 0:payment.cardHolder,className:\"form-control\",id:\"exampleInputEmail1\",\"aria-describedby\":\"emailHelp\",required:true,onChange:function onChange(ch){return setPayment(_objectSpread(_objectSpread({},payment),{},{cardHolder:ch.target.value}));}})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"form-group\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"mb-3\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"exampleInputPassword1\",className:\"form-label\",children:\"Credt/debt card number*\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:payment===null||payment===void 0?void 0:payment.cardNumber,className:\"form-control\",id:\"exampleInputPassword1\",required:true,onChange:function onChange(cn){return setPayment(_objectSpread(_objectSpread({},payment),{},{cardNumber:cn.target.value}));}})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group row\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"mb-3 col\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"form-check-label\",htmlFor:\"expire\",children:\"Expriration month and year*\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:payment===null||payment===void 0?void 0:payment.validation,className:\"form-control\",id:\"expire\",maxLength:5,required:true,onChange:function onChange(my){return setPayment(_objectSpread(_objectSpread({},payment),{},{validation:my.target.value}));}})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-3 col\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"form-check-label\",htmlFor:\"cvc\",children:\"CVC*\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:payment===null||payment===void 0?void 0:payment.cvv,className:\"form-control\",id:\"cvc\",maxLength:3,required:true,onChange:function onChange(cv){return setPayment(_objectSpread(_objectSpread({},payment),{},{cvv:cv.target.value}));}})]})]}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"btn btn-outline-primary\",children:\"Submit\"})]}):modeValue==='UPI'?/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex flex-column justify-content-center align-item-center p-2\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:upi,onChange:function onChange(text){return setUPI(text.target.value);},placeholder:\"Enter your upi id\"}),/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-outline-primary\",onClick:function onClick(){return onUpiPayment();},children:\"Submit\"})]}):modeValue==='COD'?/*#__PURE__*/_jsx(\"div\",{className:\"p-2\",children:/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-outline-primary mb-n2\",onClick:function onClick(){return onCodPayment();},children:\"COD\"})}):/*#__PURE__*/_jsx(\"div\",{className:\"form-floating\",children:/*#__PURE__*/_jsxs(\"select\",{className:\"form-select\",id:\"floatingSelect\",\"aria-label\":\"Floating label select example\",value:modeValue,onChange:handleChange,children:[/*#__PURE__*/_jsx(\"option\",{children:modeValue}),/*#__PURE__*/_jsx(\"option\",{value:\"CARD\",children:\"CARD\"}),/*#__PURE__*/_jsx(\"option\",{value:\"UPI\",children:\"UPI\"}),/*#__PURE__*/_jsx(\"option\",{value:\"COD\",children:\"COD\"})]})})})})})})});};export default Payment;","map":{"version":3,"sources":["/home/ec2-user/ShoppingApp/src/Payment.jsx"],"names":["React","useState","useEffect","useLocation","useNavigate","axios","PAYMENT_URL","ORDER_URL","Payment","props","location","navigate","console","log","state","payment","cardHolder","cardNumber","validation","cvv","setPayment","upi","setUPI","modeValue","setModeValue","cartData","setCartData","element","onPayment","event","preventDefault","kartId","JSON","parse","localStorage","getItem","user","data","mode","post","paymentresponse","orderdata","paymentId","id","userId","item","response","onUpiPayment","vpa","onCodPayment","handleChange","e","target","value","ch","cn","my","cv","text"],"mappings":"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","sourcesContent":["import React, { useState,useEffect } from 'react'\nimport { useLocation, useNavigate } from 'react-router-dom';\nimport axios from './api/axios';\nconst PAYMENT_URL = '/v1/payment'\nconst ORDER_URL = '/v1/order'\n\nconst Payment = (props) => {\n  const location = useLocation()\n  const navigate = useNavigate()\n  console.log('state', location.state);\n  const [payment = { cardHolder: '', cardNumber: '', validation: '', cvv: '' }, setPayment] = useState();\n  const [upi, setUPI] = useState()\n  const [modeValue, setModeValue] = useState('Select Mode')\n  const [cartData,setCartData] = useState()\n  useEffect(() => {\n    setCartData(location.state?.element)\n  }, [!cartData])\n  \n  const onPayment = async (event) => {\n    try {\n      event.preventDefault()\n      console.log('payment', payment);\n      // navigate('/order',{state:{paymentid:1}})\n      let kartId = JSON.parse(localStorage.getItem('cartId'))\n      let user = JSON.parse(localStorage.getItem('user'));\n      let data ={\n        kartId:kartId,\n        cardHolder:payment?.cardHolder,\n        cardNumber:payment?.cardNumber,\n        validation:payment?.validation,\n        cvv:payment?.cvv,\n        mode:'CARD',\n      }\n      let paymentresponse = await axios.post(PAYMENT_URL, data, null);\n      if (paymentresponse) {\n        let orderdata ={\n          paymentId:paymentresponse?.data?.id,\n          userId:user.id,\n          item:cartData?.item\n        }\n        let response = await axios.post(ORDER_URL, orderdata, null);\n        if (response) {\n          navigate('/success');\n        }\n      }\n      \n      \n    } catch (error) {\n      console.log('paymentError', error);\n    }\n  }\n  const onUpiPayment = async() => {\n    try {\n      let kartId = JSON.parse(localStorage.getItem('cartId'))\n      let user = JSON.parse(localStorage.getItem('user'));\n      let data ={\n        kartId:kartId,\n        mode:'UPI',\n      }\n      let paymentresponse = await axios.post(PAYMENT_URL, data, null);\n      if (paymentresponse) {\n        let orderdata ={\n          paymentId:paymentresponse?.data?.id,\n          userId:user.id,\n          vpa:upi,\n          item:cartData?.item\n        }\n        let response = await axios.post(ORDER_URL, orderdata, null);\n        if (response) {\n          navigate('/success');\n        }\n      }\n    } catch (error) {\n      console.log('upiError', error);\n    }\n  }\n  const onCodPayment = async() => {\n    try {\n      let kartId = JSON.parse(localStorage.getItem('cartId'))\n      let user = JSON.parse(localStorage.getItem('user'));\n      let data ={\n        kartId:kartId,\n        mode:'COD',\n      }\n      let paymentresponse = await axios.post(PAYMENT_URL, data, null);\n      if (paymentresponse) {\n        let orderdata ={\n          paymentId:paymentresponse?.data?.id,\n          userId:user.id,\n          item:cartData?.item\n        }\n        let response = await axios.post(ORDER_URL, orderdata, null);\n        if (response) {\n          navigate('/success');\n        }\n      }\n      \n    } catch (error) {\n      console.log('codError', error);\n    }\n  }\n  const handleChange = (e) => {\n    console.log('e', e.target.value);\n    setModeValue(e.target.value);\n  };\n  return (\n    <div className='container'>\n      <div className=\"row\">\n        <div className=\"col-md-12 d-flex justify-content-center align-item-center\">\n          <div className=\"card\">\n            <div className=\"body\">\n              {modeValue === 'CARD' ? <form className='p-2' onSubmit={onPayment}>\n                <div className=\"form-group\">\n                  <div className=\"mb-3\">\n                    <label htmlFor=\"exampleInputEmail1\" className=\"form-label\">Card holder*</label>\n                    <input type=\"text\" value={payment?.cardHolder} className=\"form-control\" id=\"exampleInputEmail1\" aria-describedby=\"emailHelp\" required onChange={(ch) => setPayment({ ...payment, cardHolder: ch.target.value })} />\n                  </div>\n                </div>\n                <div className=\"form-group\">\n                  <div className=\"mb-3\">\n                    <label htmlFor=\"exampleInputPassword1\" className=\"form-label\">Credt/debt card number*</label>\n                    <input type=\"text\" value={payment?.cardNumber} className=\"form-control\" id=\"exampleInputPassword1\" required onChange={(cn) => setPayment({ ...payment, cardNumber: cn.target.value })} />\n                  </div>\n                </div>\n                <div className=\"form-group row\">\n                  <div className=\"mb-3 col\">\n                    <label className=\"form-check-label\" htmlFor=\"expire\">Expriration month and year*</label>\n                    <input type=\"text\" value={payment?.validation} className=\"form-control\" id=\"expire\" maxLength={5} required onChange={(my) => setPayment({ ...payment, validation: my.target.value })} />\n                  </div>\n                  <div className=\"mb-3 col\">\n                    <label className=\"form-check-label\" htmlFor=\"cvc\">CVC*</label>\n                    <input type=\"text\" value={payment?.cvv} className=\"form-control\" id=\"cvc\" maxLength={3} required onChange={(cv) => setPayment({ ...payment, cvv: cv.target.value })} />\n                  </div>\n                </div>\n                <button type=\"submit\" className=\"btn btn-outline-primary\">Submit</button>\n              </form> : modeValue === 'UPI' ? <div className='d-flex flex-column justify-content-center align-item-center p-2'>\n                <input type='text' value={upi} onChange={(text) => setUPI(text.target.value)} placeholder='Enter your upi id'/>\n                <button className='btn btn-outline-primary' onClick={() => onUpiPayment()}>Submit</button>\n              </div> : modeValue === 'COD' ?<div className='p-2'><button className='btn btn-outline-primary mb-n2' onClick={() => onCodPayment()}>COD</button></div>: <div className=\"form-floating\">\n                <select className=\"form-select\" id=\"floatingSelect\" aria-label=\"Floating label select example\" value={modeValue} onChange={handleChange}>\n                  <option>{modeValue}</option>\n                  <option value=\"CARD\">CARD</option>\n                  <option value=\"UPI\">UPI</option>\n                  <option value=\"COD\">COD</option>\n                </select>\n              </div>}\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  )\n}\n\nexport default Payment\n"]},"metadata":{},"sourceType":"module"}